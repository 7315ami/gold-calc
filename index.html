<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ゴールド計算</title>
  <style>
    :root{
      --bg:#f6f7f9;
      --card:#ffffff;
      --text:#0f172a;
      --muted:#64748b;
      --line:#e5e7eb;
      --blue:#2563eb;
      --red:#b91c1c;
      --black:#0b0b0c;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Helvetica,Arial,"Hiragino Kaku Gothic ProN","Noto Sans JP","Yu Gothic",sans-serif;
      background:var(--bg);
      color:var(--text);
    }
    .wrap{max-width:820px;margin:0 auto;padding:18px 14px 60px;}
    .topbar{
      display:flex;align-items:flex-end;justify-content:space-between;gap:12px;
      padding:6px 2px 14px;
    }
    .title{
      user-select:none;
      -webkit-user-select:none;
      font-weight:900;
      font-size:40px;
      letter-spacing:-0.02em;
      line-height:1;
    }
    .subtitle{
      margin-top:6px;
      font-size:14px;
      color:var(--muted);
      font-weight:600;
    }
    .lang{
      display:flex;flex-direction:column;align-items:flex-end;gap:6px;
      min-width:160px;
    }
    .lang label{font-size:12px;color:var(--muted);font-weight:700;}
    select{
      width:160px;
      padding:10px 12px;border:1px solid var(--line);border-radius:12px;
      background:#fff;font-size:16px;
    }

    .card{
      background:var(--card);
      border:1px solid var(--line);
      border-radius:18px;
      padding:16px;
      margin:12px 0;
      box-shadow:0 1px 0 rgba(15,23,42,.03);
    }
    .section-title{
      font-size:22px;
      font-weight:900;
      margin:2px 0 12px;
    }

    .grid{
      display:grid;
      grid-template-columns:1fr;
      gap:12px;
    }
    @media (min-width:720px){
      .grid.two{grid-template-columns:1fr 1fr;}
    }

    .field label{
      display:block;
      font-size:14px;
      font-weight:800;
      margin-bottom:6px;
    }
    .hint{
      margin-top:6px;
      font-size:12px;
      color:var(--muted);
      line-height:1.3;
    }
    input{
      width:100%;
      padding:14px 14px;
      border:1px solid var(--line);
      border-radius:14px;
      font-size:18px;
      outline:none;
      background:#fff;
    }
    input:focus{border-color:#cbd5e1; box-shadow:0 0 0 3px rgba(37,99,235,.08)}
    .btn{
      width:100%;
      padding:16px 16px;
      border:none;
      border-radius:18px;
      background:var(--black);
      color:#fff;
      font-size:20px;
      font-weight:900;
      cursor:pointer;
    }
    .btn:active{transform:translateY(1px)}
    .small-note{font-size:12px;color:var(--muted);margin-top:10px}

    /* Result cards */
    .result-title{
      font-size:18px;
      color:var(--muted);
      font-weight:800;
      margin-bottom:8px;
    }
    .big{
      font-size:40px;
      font-weight:1000;
      letter-spacing:-0.02em;
      line-height:1.05;
    }
    .big.black{color:var(--text)}
    .big.blue{color:var(--blue)}
    .big.red{color:var(--red)}
    .mono{font-variant-numeric:tabular-nums}
    .equation{
      margin-top:10px;
      font-size:13px;
      color:var(--muted);
      line-height:1.35;
    }

    /* Accordion */
    .acc{
      border:1px solid var(--line);
      border-radius:16px;
      overflow:hidden;
      background:#fff;
      margin:12px 0 0;
    }
    .acc button{
      width:100%;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      padding:14px 14px;
      border:none;
      background:#fff;
      cursor:pointer;
      font-size:16px;
      font-weight:900;
    }
    .acc .chev{font-size:16px;color:var(--muted)}
    .acc .panel{
      display:none;
      border-top:1px solid var(--line);
      padding:14px;
      background:#fff;
    }
    .acc.open .panel{display:block}
    .acc.open .chev{transform:rotate(180deg)}
    .acc .panel h4{
      margin:6px 0 10px;
      font-size:16px;
      font-weight:1000;
    }
    .rows{display:grid;gap:10px}
    .row{
      display:flex;align-items:center;justify-content:space-between;gap:12px;
      border-bottom:1px dashed #eef2f7;
      padding-bottom:10px;
    }
    .row:last-child{border-bottom:none;padding-bottom:0}
    .row .k{color:var(--text);font-weight:800}
    .row .v{font-weight:1000}
    .badge{
      display:inline-block;
      margin-left:8px;
      padding:2px 10px;
      border:1px solid var(--line);
      border-radius:999px;
      font-size:12px;
      color:var(--muted);
      font-weight:900;
      background:#fafafa;
    }
    .emph{
      padding:12px 12px;
      border:1px solid #dbeafe;
      background:#eff6ff;
      border-radius:14px;
    }
    .emph .k{font-weight:1000}
    .emph .v{font-size:20px}

    /* Gate */
    .gate{
      position:fixed;inset:0;
      background:rgba(15,23,42,.55);
      display:flex;align-items:center;justify-content:center;
      padding:18px;
      z-index:50;
    }
    .gate .box{
      width:min(560px,100%);
      background:#fff;
      border-radius:20px;
      border:1px solid var(--line);
      padding:18px;
      box-shadow:0 18px 55px rgba(0,0,0,.25);
    }
    .gate .box h2{
      margin:0 0 8px;
      font-size:22px;
      font-weight:1000;
    }
    .gate .box p{margin:0 0 14px;color:var(--muted);font-weight:700}
    .gate .box .err{margin-top:10px;color:var(--red);font-weight:900;display:none}
    .gate .box .rowbtn{display:flex;gap:10px;margin-top:12px}
    .gate .box .rowbtn button{
      flex:1;
      border:none;border-radius:14px;
      padding:12px 12px;
      font-size:16px;
      font-weight:1000;
      cursor:pointer;
    }
    .gate .box .rowbtn .ok{background:var(--black);color:#fff}
    .gate .box .rowbtn .clear{background:#eef2f7;color:var(--text)}
    .foot{
      margin-top:14px;
      text-align:center;
      color:var(--muted);
      font-size:12px;
      font-weight:700;
    }
  </style>
</head>
<body>

  <!-- Gate -->
  <div class="gate" id="gate" style="display:none;">
    <div class="box">
      <h2>アクセスコード</h2>
      <p>コードを入力すると計算画面が開きます。</p>
      <div class="field">
        <label for="gateInput">コード</label>
        <input id="gateInput" inputmode="text" autocomplete="off" placeholder="例：sawa / 1111" />
        <div class="err" id="gateErr">コードが違います。</div>
      </div>
      <div class="rowbtn">
        <button class="clear" type="button" id="gateClear">クリア</button>
        <button class="ok" type="button" id="gateOk">入る</button>
      </div>
      <div class="foot">（大文字・小文字は区別しません）</div>
    </div>
  </div>

  <div class="wrap" id="app" style="display:none;">
    <div class="topbar">
      <div>
        <!-- 8回タップで「設定アンロック」 -->
        <div class="title" id="tapTitle">ゴールド計算</div>
        <div class="subtitle" id="subTitle">シンプル・速い・ミスなし</div>
      </div>

      <div class="lang">
        <label for="langSel">言語</label>
        <select id="langSel">
          <option value="ja" selected>日本語</option>
          <option value="en">English</option>
        </select>
      </div>
    </div>

    <div class="card">
      <div class="section-title" id="inputTitle">入力</div>

      <div class="grid two">
        <div class="field">
          <label id="lblUnitPrice">購入単価（GHS / Ghana pound）</label>
          <input id="unitPrice" inputmode="decimal" placeholder="例：11000" value="11000" />
          <div class="hint" id="hintUnitPrice">※ 1 Ghana pound あたりの価格</div>
        </div>

        <div class="field">
          <label id="lblFx">為替（1 GHS → JPY）</label>
          <input id="fx" inputmode="decimal" placeholder="例：14.5" value="14.5" />
          <div class="hint" id="hintFx">※ 利益計算の換算に使用</div>
        </div>
      </div>

      <div class="grid two">
        <div class="field">
          <label id="lblPound">重量（Ghana pound）</label>
          <input id="weightPound" inputmode="decimal" placeholder="例：10" />
        </div>

        <div class="field">
          <label id="lblGram">重量（g）</label>
          <input id="weightG" inputmode="decimal" placeholder="例：78" />
          <div class="hint" id="hintConv">※ 1 Ghana pound = 7.8 g（固定）／どちらを編集しても連動</div>
        </div>
      </div>

      <div class="grid">
        <div class="field">
          <label id="lblJpPrice">日本24金 買取参考価格（JPY/g）</label>
          <input id="jpPrice" inputmode="decimal" placeholder="例：26000" value="27000" />
          <div class="hint" id="hintJpPrice">※ ここが「日本24金 買取参考価格」を決めます</div>
        </div>
      </div>

      <!-- コスト設定（通常は閉じる・設定は隠す） -->
      <div class="acc" id="settingsAcc" style="margin-top:14px; display:none;">
        <button type="button" id="settingsBtn">
          <span id="settingsBtnText">コスト設定（タップで開く）</span>
          <span class="chev">▼</span>
        </button>
        <div class="panel">
          <div class="small-note" id="settingsNote">※ ここは「設定アンロック」後に編集できます。</div>

          <div class="grid two" style="margin-top:10px;">
            <div class="field">
              <label id="lblGovPct">政府関係手数料（%）</label>
              <input id="govPct" inputmode="decimal" value="10" disabled />
            </div>
            <div class="field">
              <label id="lblShipPct">輸出・保険（%）</label>
              <input id="shipPct" inputmode="decimal" value="6" disabled />
            </div>
          </div>

          <div class="grid two">
            <div class="field">
              <label id="lblOtherGHS">ガーナ側 その他コスト（GHS）</label>
              <input id="otherGHS" inputmode="decimal" value="0" disabled />
            </div>
            <div class="field">
              <label id="lblTaxPct">日本側 税率（%）</label>
              <input id="taxPct" inputmode="decimal" value="10" disabled />
            </div>
          </div>

          <div class="grid two">
            <div class="field">
              <label id="lblRefine">精錬コスト（JPY/g）</label>
              <input id="refineJPY" inputmode="decimal" value="100" disabled />
            </div>
            <div class="field">
              <label id="lblOtherJPY">日本側 その他コスト（JPY）</label>
              <input id="otherJPY" inputmode="decimal" value="0" disabled />
            </div>
          </div>

          <div class="small-note" id="unlockHelp" style="margin-top:12px;">
            ※ 編集したい場合：タイトル「ゴールド計算」を素早く8回タップ → 設定が編集可能になります。
          </div>
        </div>
      </div>

      <button class="btn" id="calcBtn" type="button">計算</button>
      <div class="small-note" id="calcHint">ヒント：入力して「計算」。（入力中も自動更新します）</div>
    </div>

    <!-- Results -->
    <div class="card">
      <div class="section-title" id="resultTitle">結果（ここだけ見れば判断できる）</div>

      <!-- 1. 支払う総額（最重要） -->
      <div class="card" style="margin:0 0 12px;">
        <div class="result-title" id="lblPayTotal">支払う総額（JPY）</div>
        <div class="big black mono" id="payTotal">—</div>
        <div class="equation" id="eqPayTotal">
          =（ガーナ総コストGHS × 為替）+ 税 + 精錬 + 日本その他
        </div>
      </div>

      <!-- 2. 内訳（タップで開く） -->
      <div class="acc" id="breakAcc">
        <button type="button" id="breakBtn">
          <span id="breakBtnText">内訳（タップで開く）</span>
          <span class="chev">▼</span>
        </button>
        <div class="panel">
          <div class="rows">
            <div>
              <h4 id="hGhana">ガーナ側（GHS）</h4>

              <div class="row">
                <div class="k" id="kPurchaseGHS">購入合計</div>
                <div class="v mono" id="vPurchaseGHS">—</div>
              </div>

              <div class="row">
                <div class="k" id="kGovFee">
                  政府関係手数料
                  <span class="badge mono" id="bGovPct">10%</span>
                </div>
                <div class="v mono" id="vGovFee">—</div>
              </div>

              <div class="row">
                <div class="k" id="kShipFee">
                  輸出・保険
                  <span class="badge mono" id="bShipPct">6%</span>
                </div>
                <div class="v mono" id="vShipFee">—</div>
              </div>

              <div class="row">
                <div class="k" id="kOtherGHS2">その他コスト</div>
                <div class="v mono" id="vOtherGHS">—</div>
              </div>

              <div class="row emph">
                <div class="k" id="kGhanaTotal">ガーナ総コスト</div>
                <div class="v mono" id="vGhanaTotal">—</div>
              </div>

              <div class="equation" style="margin-top:10px;">
                <span class="mono" id="wLine">重量 —</span>
              </div>
            </div>

            <div style="margin-top:14px;">
              <h4 id="hJapan">日本側（JPY）</h4>

              <div class="row">
                <div class="k" id="kCIF">CIF課税対象額（参考）</div>
                <div class="v mono" id="vCIF">—</div>
              </div>

              <div class="row">
                <div class="k" id="kTax">
                  税
                  <span class="badge mono" id="bTaxPct">10%</span>
                </div>
                <div class="v mono" id="vTax">—</div>
              </div>

              <div class="row">
                <div class="k" id="kRefine">精錬コスト</div>
                <div class="v mono" id="vRefine">—</div>
              </div>

              <div class="row">
                <div class="k" id="kOtherJPY2">日本その他</div>
                <div class="v mono" id="vOtherJPY">—</div>
              </div>

              <div class="row emph">
                <div class="k" id="kJapanTotal">日本総コスト</div>
                <div class="v mono" id="vJapanTotal">—</div>
              </div>

              <div class="equation" id="noteCIF" style="margin-top:10px;">
                注：CIF課税対象額は「ガーナ総コスト（GHS）×為替」を参考値として表示しています。
              </div>

              <div class="equation" style="margin-top:10px;">
                <span class="mono" id="fxLine">為替 —</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- 3. 最終利益（青/赤） -->
      <div class="card" style="margin:12px 0;">
        <div class="result-title" id="lblProfit">最終利益（JPY）</div>
        <div class="big mono" id="profit">—</div>
        <div class="equation" id="eqProfit">= 日本24金 買取参考価格（JPY） − 支払う総額（JPY）</div>
      </div>

      <!-- 4. 利益率（青/赤） -->
      <div class="card" style="margin:0 0 12px;">
        <div class="result-title" id="lblMargin">利益率（%）</div>
        <div class="big mono" id="margin">—</div>
        <div class="equation" id="eqMargin">= 最終利益 ÷ 支払う総額</div>
      </div>

      <!-- 5. 日本24金 買取参考価格（JPY） -->
      <div class="card" style="margin:0;">
        <div class="result-title" id="lblRevenue">日本24金 買取参考価格（JPY）</div>
        <div class="big black mono" id="revenue">—</div>
        <div class="equation" id="eqRevenue">= 日本24金 買取参考価格（JPY/g）× 重さ（g）</div>
      </div>

    </div>

    <div class="foot">7315ami.github.io</div>
  </div>

<script>
(() => {
  // ====== Gate settings ======
  // どちらでもOK：sawa（大小無視） / 1111
  const GATE_OK = (v) => {
    const s = (v ?? "").trim();
    if (!s) return false;
    if (s === "1111") return true;
    return s.toLowerCase() === "sawa";
  };

  const gate = document.getElementById("gate");
  const app = document.getElementById("app");
  const gateInput = document.getElementById("gateInput");
  const gateErr = document.getElementById("gateErr");
  const gateOk = document.getElementById("gateOk");
  const gateClear = document.getElementById("gateClear");

  function openApp() {
    gate.style.display = "none";
    app.style.display = "block";
    try { sessionStorage.setItem("goldcalc_gate_ok", "1"); } catch(e){}
  }

  function needGate() {
    try { return sessionStorage.getItem("goldcalc_gate_ok") !== "1"; }
    catch(e){ return true; }
  }

  function showGate() {
    gate.style.display = "flex";
    app.style.display = "none";
    gateErr.style.display = "none";
    gateInput.value = "";
    setTimeout(() => gateInput.focus(), 50);
  }

  function tryGate() {
    if (GATE_OK(gateInput.value)) {
      openApp();
      recalc();
    } else {
      gateErr.style.display = "block";
    }
  }

  gateOk.addEventListener("click", tryGate);
  gateClear.addEventListener("click", () => { gateInput.value = ""; gateErr.style.display = "none"; gateInput.focus(); });
  gateInput.addEventListener("keydown", (e) => { if (e.key === "Enter") tryGate(); });

  if (needGate()) showGate(); else openApp();

  // ====== Elements ======
  const unitPrice = document.getElementById("unitPrice");
  const fx = document.getElementById("fx");
  const weightPound = document.getElementById("weightPound");
  const weightG = document.getElementById("weightG");
  const jpPrice = document.getElementById("jpPrice");

  const settingsAcc = document.getElementById("settingsAcc");
  const settingsBtn = document.getElementById("settingsBtn");
  const govPct = document.getElementById("govPct");
  const shipPct = document.getElementById("shipPct");
  const otherGHS = document.getElementById("otherGHS");
  const taxPct = document.getElementById("taxPct");
  const refineJPY = document.getElementById("refineJPY");
  const otherJPY = document.getElementById("otherJPY");

  const calcBtn = document.getElementById("calcBtn");

  // Results
  const payTotalEl = document.getElementById("payTotal");
  const revenueEl = document.getElementById("revenue");
  const profitEl = document.getElementById("profit");
  const marginEl = document.getElementById("margin");

  // Breakdown
  const vPurchaseGHS = document.getElementById("vPurchaseGHS");
  const vGovFee = document.getElementById("vGovFee");
  const vShipFee = document.getElementById("vShipFee");
  const vOtherGHSEl = document.getElementById("vOtherGHS");
  const vGhanaTotal = document.getElementById("vGhanaTotal");

  const vCIF = document.getElementById("vCIF");
  const vTax = document.getElementById("vTax");
  const vRefine = document.getElementById("vRefine");
  const vOtherJPYEl = document.getElementById("vOtherJPY");
  const vJapanTotal = document.getElementById("vJapanTotal");

  const bGovPct = document.getElementById("bGovPct");
  const bShipPct = document.getElementById("bShipPct");
  const bTaxPct = document.getElementById("bTaxPct");
  const wLine = document.getElementById("wLine");
  const fxLine = document.getElementById("fxLine");

  // Accordions
  const breakAcc = document.getElementById("breakAcc");
  const breakBtn = document.getElementById("breakBtn");

  // ====== Helpers ======
  const CONV = 7.8; // fixed
  const fmtInt = (n) => {
    if (!isFinite(n)) return "—";
    const x = Math.round(n);
    return x.toLocaleString("ja-JP");
  };
  const fmtMoney = (n, suffix) => {
    if (!isFinite(n)) return "—";
    return `${fmtInt(n)} ${suffix}`;
  };
  const fmtPct = (n) => {
    if (!isFinite(n)) return "—";
    const x = Math.round(n * 100) / 100;
    return `${x.toFixed(2)}%`;
  };
  const num = (el) => {
    const s = (el.value ?? "").toString().replace(/,/g,"").trim();
    if (!s) return NaN;
    const x = Number(s);
    return isFinite(x) ? x : NaN;
  };

  // ====== Weight linkage (two-way) ======
  let syncing = false;
  function setWeightFromPound() {
    if (syncing) return;
    syncing = true;
    const p = num(weightPound);
    if (isFinite(p)) weightG.value = (p * CONV).toString();
    syncing = false;
  }
  function setWeightFromGram() {
    if (syncing) return;
    syncing = true;
    const g = num(weightG);
    if (isFinite(g)) weightPound.value = (g / CONV).toString();
    syncing = false;
  }

  weightPound.addEventListener("input", () => { setWeightFromPound(); recalc(); });
  weightG.addEventListener("input", () => { setWeightFromGram(); recalc(); });

  // ====== Accordions ======
  function toggleAcc(acc){ acc.classList.toggle("open"); }
  breakBtn.addEventListener("click", () => toggleAcc(breakAcc));
  settingsBtn.addEventListener("click", () => toggleAcc(settingsAcc));

  // ====== Settings unlock (8 taps on title) ======
  const tapTitle = document.getElementById("tapTitle");
  let taps = 0;
  let tapTimer = null;
  let settingsUnlocked = false;

  function showSettings() {
    settingsAcc.style.display = "block";
  }
  function unlockSettings() {
    settingsUnlocked = true;
    showSettings();
    // editable now
    [govPct, shipPct, otherGHS, taxPct, refineJPY, otherJPY].forEach(i => i.disabled = false);
  }

  tapTitle.addEventListener("click", () => {
    taps++;
    if (tapTimer) clearTimeout(tapTimer);
    tapTimer = setTimeout(() => { taps = 0; }, 900);
    if (taps >= 8 && !settingsUnlocked) {
      taps = 0;
      unlockSettings();
    }
  });

  // 入力変更で再計算
  [unitPrice, fx, jpPrice, govPct, shipPct, otherGHS, taxPct, refineJPY, otherJPY].forEach(el => {
    el.addEventListener("input", recalc);
  });

  calcBtn.addEventListener("click", recalc);

  // ====== Main calculation ======
  function recalc() {
    const unit = num(unitPrice);              // GHS / pound
    const fxRate = num(fx);                   // JPY per GHS
    const p = num(weightPound);
    const g = num(weightG);
    const jp = num(jpPrice);                  // JPY / g

    const gov = num(govPct);
    const ship = num(shipPct);
    const oGHS = num(otherGHS);
    const tax = num(taxPct);
    const refine = num(refineJPY);
    const oJPY = num(otherJPY);

    const purchaseTotalGHS = unit * p;
    const govFeeGHS = purchaseTotalGHS * (gov/100);
    const shipFeeGHS = purchaseTotalGHS * (ship/100);
    const ghanaTotalGHS = purchaseTotalGHS + govFeeGHS + shipFeeGHS + (isFinite(oGHS)?oGHS:0);

    const cifJPY = ghanaTotalGHS * fxRate;
    const taxJPY = cifJPY * (tax/100);
    const refineTotalJPY = refine * g;
    const japanTotalJPY = cifJPY + taxJPY + refineTotalJPY + (isFinite(oJPY)?oJPY:0);

    const revenueJPY = jp * g;
    const profitJPY = revenueJPY - japanTotalJPY;
    const margin = profitJPY / japanTotalJPY * 100;

    // Output: main order
    payTotalEl.textContent = fmtMoney(japanTotalJPY, "JPY");
    revenueEl.textContent = fmtMoney(revenueJPY, "JPY");

    // profit color
    profitEl.textContent = fmtMoney(profitJPY, "JPY");
    profitEl.classList.remove("blue","red","black");
    marginEl.classList.remove("blue","red","black");

    const good = isFinite(profitJPY) && profitJPY >= 0;
    profitEl.classList.add(good ? "blue" : "red");
    marginEl.classList.add(good ? "blue" : "red");

    marginEl.textContent = isFinite(margin) ? fmtPct(margin) : "—";

    // Breakdown numbers
    vPurchaseGHS.textContent = fmtMoney(purchaseTotalGHS, "GHS");
    vGovFee.textContent = fmtMoney(govFeeGHS, "GHS");
    vShipFee.textContent = fmtMoney(shipFeeGHS, "GHS");
    vOtherGHSEl.textContent = fmtMoney(isFinite(oGHS)?oGHS:0, "GHS");
    vGhanaTotal.textContent = fmtMoney(ghanaTotalGHS, "GHS");

    vCIF.textContent = fmtMoney(cifJPY, "JPY");
    vTax.textContent = fmtMoney(taxJPY, "JPY");
    vRefine.textContent = fmtMoney(refineTotalJPY, "JPY");
    vOtherJPYEl.textContent = fmtMoney(isFinite(oJPY)?oJPY:0, "JPY");
    vJapanTotal.textContent = fmtMoney(japanTotalJPY, "JPY");

    // badges
    bGovPct.textContent = isFinite(gov) ? `${gov}%` : "—";
    bShipPct.textContent = isFinite(ship) ? `${ship}%` : "—";
    bTaxPct.textContent = isFinite(tax) ? `${tax}%` : "—";

    // lines
    const pp = isFinite(p) ? (Math.round(p*100)/100).toFixed(2) : "—";
    const gg = isFinite(g) ? (Math.round(g*100)/100).toFixed(2) : "—";
    wLine.textContent = `重量 ${pp} pound = ${gg} g`;
    fxLine.textContent = isFinite(fxRate) ? `為替 1 GHS → ${fxRate} JPY` : `為替 —`;
  }

  // 初回：g入力があればp計算、p入力があればg計算（空なら何もしない）
  if ((weightPound.value ?? "").trim() && !(weightG.value ?? "").trim()) setWeightFromPound();
  if ((weightG.value ?? "").trim() && !(weightPound.value ?? "").trim()) setWeightFromGram();

  recalc();

  // 設定は「アンロック」まで見せない（要望：表に出さない）
  // ※ 8回タップで表示＆編集可能になる
})();
</script>
</body>
</html>